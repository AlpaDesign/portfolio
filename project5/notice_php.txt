<pre class="code_text"><span class="num">1</span><span class="text">&lt;?
</span></pre>
<pre class="code_text"><span class="num">2</span><span class="text"><span class="blue">include</span> <span class="orange">"../db.php"</span>;
</span></pre>
<pre class="code_text"><span class="num">3</span><span class="text">$dir = <span class="orange">"./image"</span>;<span class="gray">// 저장될 dir
</span></span></pre>
<pre class="code_text"><span class="num">4</span><span class="text"><span class="blue">if</span><span class="white">(</span> !file_exists<span class="white">(</span> $dir ) ) mkdir<span class="white">(</span> $dir );<span class="gray">//dir이 없으면 만들기
</span></span></pre>
<pre class="code_text"><span class="num">5</span><span class="text">$file_types = array<span class="white">(</span> <span class="orange">"png"</span>, <span class="orange">"jpeg"</span>, <span class="orange">"jpg"</span>, <span class="orange">"g<span class="blue">if</span>"</span> );<span class="gray">//업로드 허용할 파일확장자
</span></span></pre>
<pre class="code_text"><span class="num">6</span><span class="text">$upload_check = <span class="orange">false</span>;
</span></pre>
<pre class="code_text"><span class="num">7</span><span class="text">
</span></pre>
<pre class="code_text"><span class="num">8</span><span class="text">$ragdata=date<span class="white">(</span><span class="orange">"Y-m-d H:i:s"</span>);
</span></pre>
<pre class="code_text"><span class="num">9</span><span class="text">$title = $_GET[<span class="orange">'title'</span>];
</span></pre>
<pre class="code_text"><span class="num">10</span><span class="text">$content = $_GET[<span class="orange">'content'</span>];
</span></pre>
<pre class="code_text"><span class="num">11</span><span class="text">$check =$_GET[<span class="orange">'check'</span>];
</span></pre>
<pre class="code_text"><span class="num">12</span><span class="text">
</span></pre>
<pre class="code_text"><span class="num">13</span><span class="text"><span class="blue">if</span><span class="white">(</span>$content === <span class="orange">""</span>)<span class="white">{</span>
</span></pre>
<pre class="code_text"><span class="num">14</span><span class="text">    echo <span class="orange">"내용을 입력하세요"</span>;
</span></pre>
<pre class="code_text"><span class="num">15</span><span class="text">    exit;
</span></pre>
<pre class="code_text"><span class="num">16</span><span class="text">}
</span></pre>
<pre class="code_text"><span class="num">17</span><span class="text"><span class="blue">if</span><span class="white">(</span>$title === <span class="orange">""</span>)<span class="white">{</span>
</span></pre>
<pre class="code_text"><span class="num">18</span><span class="text">    echo <span class="orange">"제목을 입력하세요"</span>;
</span></pre>
<pre class="code_text"><span class="num">19</span><span class="text">    exit;
</span></pre>
<pre class="code_text"><span class="num">20</span><span class="text">}
</span></pre>
<pre class="code_text"><span class="num">21</span><span class="text">
</span></pre>
<pre class="code_text"><span class="num">22</span><span class="text"><span class="blue">function</span> GenerateString<span class="white">(</span>$length)  
</span></pre>
<pre class="code_text"><span class="num">23</span><span class="text"><span class="white">{</span>  
</span></pre>
<pre class="code_text"><span class="num">24</span><span class="text">    $characters  = <span class="orange">"0123456789"</span>;  
</span></pre>
<pre class="code_text"><span class="num">25</span><span class="text">    $characters .= <span class="orange">"abcdefghijklmnopqrstuvwxyz"</span>;  
</span></pre>
<pre class="code_text"><span class="num">26</span><span class="text">    $characters .= <span class="orange">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>;  
</span></pre>
<pre class="code_text"><span class="num">27</span><span class="text">    $characters .= <span class="orange">"_"</span>;  
</span></pre>
<pre class="code_text"><span class="num">28</span><span class="text">      
</span></pre>
<pre class="code_text"><span class="num">29</span><span class="text">    $string_generated = <span class="orange">""</span>;  
</span></pre>
<pre class="code_text"><span class="num">30</span><span class="text">      
</span></pre>
<pre class="code_text"><span class="num">31</span><span class="text">    $nmr_loops = $length;  
</span></pre>
<pre class="code_text"><span class="num">32</span><span class="text">    <span class="blue"><span class="blue">while</span></span> <span class="white">(</span>$nmr_loops--)  
</span></pre>
<pre class="code_text"><span class="num">33</span><span class="text">    <span class="white">{</span>  
</span></pre>
<pre class="code_text"><span class="num">34</span><span class="text">        $string_generated .= $characters[mt_rand<span class="white">(</span>0, strlen<span class="white">(</span>$characters) - 1)];  
</span></pre>
<pre class="code_text"><span class="num">35</span><span class="text">    } 
</span></pre>
<pre class="code_text"><span class="num">36</span><span class="text">    return $string_generated;  
</span></pre>
<pre class="code_text"><span class="num">37</span><span class="text">}
</span></pre>
<pre class="code_text"><span class="num">38</span><span class="text">
</span></pre>
<pre class="code_text"><span class="num">39</span><span class="text">$querys = "insert into notice<span class="white">(</span>chk, title, content, ragdata, file) 
</span></pre>
<pre class="code_text"><span class="num">40</span><span class="text">            values<span class="white">(</span><span class="orange">'$check'</span>,<span class="orange">'$title'</span>,<span class="orange">'$content'</span>,<span class="orange">'$ragdata'</span>,'";
</span></pre>
<pre class="code_text"><span class="num">41</span><span class="text">
</span></pre>
<pre class="code_text"><span class="num">42</span><span class="text"><span class="blue"><span class="blue">for</span></span><span class="white">(</span>$i=0; $i&lt;$_POST[<span class="orange">'image_count'</span>]; $i++) <span class="white">{</span>
</span></pre>
<pre class="code_text"><span class="num">43</span><span class="text">    $img_file = $_FILES[$i];<span class="gray">//POST로 넘어온 file 데이터
</span></span></pre>
<pre class="code_text"><span class="num">44</span><span class="text">    $ext = substr<span class="white">(</span>strrchr<span class="white">(</span>$img_file[<span class="orange">'name'</span>], <span class="orange">'.'</span>), 1); <span class="gray">//확장자 구하기
</span></span></pre>
<pre class="code_text"><span class="num">45</span><span class="text">    $named = GenerateString<span class="white">(</span>12);
</span></pre>
<pre class="code_text"><span class="num">46</span><span class="text">    $file_name = <span class="orange">"$named.$ext"</span>;
</span></pre>
<pre class="code_text"><span class="num">47</span><span class="text">    $querys = $querys.<span class="orange">"$file_name, "</span>;
</span></pre>
<pre class="code_text"><span class="num">48</span><span class="text">
</span></pre>
<pre class="code_text"><span class="num">49</span><span class="text">    <span class="blue">if</span><span class="white">(</span> in_array<span class="white">(</span>$ext, $file_types) )<span class="white">{</span>
</span></pre>
<pre class="code_text"><span class="num">50</span><span class="text">        <span class="blue">if</span><span class="white">(</span> move_uploaded_file<span class="white">(</span>$img_file[<span class="orange">'tmp_name'</span>], <span class="orange">"$dir/$file_name"</span>))<span class="white">{</span><span class="gray">//파일 업로드
</span></span></pre>
<pre class="code_text"><span class="num">51</span><span class="text">            $upload_check = <span class="orange">true</span>;
</span></pre>
<pre class="code_text"><span class="num">52</span><span class="text">        }
</span></pre>
<pre class="code_text"><span class="num">53</span><span class="text">        <span class="blue"><span class="blue">else</span></span> error_log<span class="white">(</span> <span class="orange">"error"</span> );
</span></pre>
<pre class="code_text"><span class="num">54</span><span class="text">    }
</span></pre>
<pre class="code_text"><span class="num">55</span><span class="text">}
</span></pre>
<pre class="code_text"><span class="num">56</span><span class="text">$querys = $querys.<span class="orange">"')"</span>;
</span></pre>
<pre class="code_text"><span class="num">57</span><span class="text">$results = mysqli_query<span class="white">(</span>$db, $querys);
</span></pre>
<pre class="code_text"><span class="num">58</span><span class="text">
</span></pre>
<pre class="code_text"><span class="num">59</span><span class="text">?&gt;
</span></pre>